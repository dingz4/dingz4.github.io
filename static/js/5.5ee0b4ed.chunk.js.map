{"version":3,"sources":["utils/user.ts","components/id-select.tsx","components/user-select.tsx","screens/project-list/search-panel.tsx","utils/reorder.ts","utils/use-optimistic-opinion.ts","utils/project.ts","components/pin.tsx","utils/url.ts","screens/project-list/util.ts","screens/project-list/list.tsx","screens/project-list/index.tsx","utils/kanban.ts","utils/task.ts","screens/kanban/util.ts","utils/task-type.ts","assets/task.svg","assets/bug.svg","screens/kanban/create-task.tsx","components/mark.tsx","components/drag-and-drop.tsx","screens/kanban/kanban-column.tsx","components/task-type-select.tsx","screens/kanban/search-panel.tsx","screens/kanban/create-kanban.tsx","screens/kanban/task-modal.tsx","screens/kanban/index.tsx","screens/epic/util.ts","screens/epic/create-epic.tsx","utils/epic.ts","screens/epic/index.tsx","screens/project/index.tsx","assets/software-logo.svg","screens/project-list/project-modal.tsx","components/project-popover.tsx","components/user-popover.tsx","authenticated-app.tsx"],"names":["useUsers","param","client","useHttp","useQuery","data","IdSelect","props","value","onChange","defaultOptionName","options","restProps","length","toNumber","undefined","Option","map","option","id","name","isNaN","Number","UserSelect","users","SearchPanel","setParam","style","marginBottom","layout","Item","placeholder","type","evt","target","personId","reorder","fromId","referenceId","list","copiedList","movingItemIndex","findIndex","item","insertAfter","targetIndex","insertBefore","from","to","toItem","removedItem","splice","toIndex","indexOf","useConfig","queryKey","callback","queryClient","useQueryClient","onSuccess","invalidateQueries","onMutate","previousItems","getQueryData","setQueryData","old","onError","error","newItem","context","useDeleteConfig","filter","useEditConfig","useAddConfig","useProjects","useEditProject","useMutation","params","method","useAddProject","useProject","enabled","Boolean","Pin","checked","onCheckedChange","count","num","useUrlQueryParam","keys","useSearchParams","searchParams","setSearchParams","useSetUrlSearchParam","useState","stateKeys","useMemo","subset","Object","fromEntries","setSearchParam","o","cleanObject","useProjectsSearchParams","useProjectsQueryKey","useProjectModal","projectCreate","setProjectCreate","editingProjectId","setEditingProjectId","setUrlParams","editingProject","isLoading","projectModalOpen","open","close","startEdit","List","mutate","rowKey","pagination","columns","title","disabled","render","project","pin","sorter","a","b","localeCompare","String","dataIndex","find","user","created","dayjs","format","More","deleteProject","useDeleteProject","overlay","onClick","Modal","confirm","content","onOk","confirmDeleteProject","ProjectListScreen","useDocumentTitle","useDebounce","between","loading","dataSource","useKanbans","useReorderKanban","useReorderKanbanConfig","useTasks","useReorderTask","kanbanId","toKanbanId","useReorderTaskConfig","useProjectIdInUrl","useLocation","pathname","match","useProjectInUrl","useKanbanSearchParams","projectId","useKanbansQueryKey","useTasksSearchParams","debounceName","typeId","processorId","tagId","useTasksQueryKey","useTasksModal","editingTaskId","setEditingTaskId","useTask","editingTask","useCallback","useTaskTypes","CreateTask","setName","addTask","useAddTask","mutateAsync","inputMode","setInputMode","submit","toggle","mode","useEffect","onBlur","autoFocus","onPressEnter","Mark","keyword","arr","split","str","index","color","Drop","children","provided","React","isValidElement","cloneElement","droppableProps","ref","innerRef","DropChild","forwardRef","Drag","draggableProps","dragHandleProps","TaskTypeIcon","taskTypes","taskType","alt","src","taskIcon","bugIcon","TaskCard","task","cursor","KanbanColumn","kanban","allTasks","tasks","Container","TasksContainer","direction","droppableId","taskIndex","draggableId","useDeleteKanban","okText","cancelText","styled","div","TaskTypeSelect","gap","width","CreateKanban","addKanban","useAddKanban","size","labelCol","span","wrapper","TaskModal","Form","useForm","form","useEditTask","editTask","editLoading","deleteTask","useDeleteTask","getFieldsValue","setFieldsValue","forceRender","onCancel","resetFields","confirmLoading","visible","initialValues","label","rules","required","message","textAlign","fontSize","KanbanScreen","currentProject","kanbans","kanbanIsLoading","onDragEnd","useDragEnd","ColumnsContainer","display","reorderKanban","reorderTask","source","destination","toId","fromKanbanId","fromTask","toTask","useEpicSearchParams","useEpicsQueryKey","CreateEpic","useAddEpic","addEpic","onFinish","values","onClose","destroyOnClose","htmlType","EpicScreen","epics","useEpics","deleteEpic","useDeleteEpic","epicCreateOpen","setEpicCreateOpen","overflow","itemLayout","renderItem","epic","Meta","confirmDeleteEpic","description","start","end","epicId","ProjectScreen","routeType","units","useRouteType","Aside","selectedKeys","Main","path","element","window","location","replace","aside","_extends","assign","i","arguments","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","x1","y1","x2","y2","stopColor","offset","stroke","strokeWidth","fillRule","d","fill","SvgSoftwareLogo","_ref","svgRef","titleId","viewBox","xmlns","focusable","className","ForwardRef","ProjectModal","mutateLoading","then","ProjectPopover","projects","refetch","pinnedProjects","ContentContainer","Text","onVisibleChange","placement","UserPopover","PageHeader","Header","HeaderLeft","resetRoute","HeaderRight","User","useAuth","logout","e","preventDefault","Row","main"],"mappings":"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","file":"static/js/5.5ee0b4ed.chunk.js","sourcesContent":["import { useHttp } from \"utils/http\";\r\nimport { User } from \"types/user\";\r\nimport { useQuery } from \"react-query\";\r\n\r\nexport const useUsers = (param?: Partial<User>) => {\r\n    const client = useHttp();\r\n\r\n    return useQuery<User[]>([\"users\", param], () =>\r\n        client(\"users\", { data: param })\r\n    );\r\n};","import React from 'react';\r\nimport {Raw} from \"types\";\r\nimport {Select} from \"antd\";\r\n\r\ntype SelectProps = React.ComponentProps<typeof Select>\r\n\r\ninterface IdSelectProps extends Omit<SelectProps, 'value' | 'onChange' | 'options'>{\r\n    value?:  Raw | null | undefined\r\n    onChange?: (value?:number) => void\r\n    defaultOptionName?:string,\r\n    options?: {name:string, id: number}[]\r\n}\r\n\r\n/**\r\n * value 可以传入多种类型的值\r\n * onChange只会回调 number|undefined 类型\r\n * 当 isNaN(Number(value)) 为true的时候，代表选择默认类型\r\n * 当选择默认类型的时候，onChange会回调undefined\r\n * @param props\r\n * @constructor\r\n */\r\nexport const IdSelect = (props : IdSelectProps) => {\r\n    const  {value, onChange, defaultOptionName, options, ...restProps} = props\r\n    return <Select\r\n        value={options?.length ? toNumber(value) : 0}\r\n            onChange={(value) => onChange?.(toNumber(value) || undefined)}\r\n        {...restProps}\r\n            >\r\n        {\r\n            defaultOptionName ? <Select.Option value={0}>{defaultOptionName}</Select.Option> : null\r\n        }\r\n        {options?.map((option) => (\r\n            <Select.Option key={option.id} value={option.id}>\r\n                {option.name}\r\n            </Select.Option>\r\n        ))}\r\n    </Select>\r\n}\r\n\r\nconst toNumber = (value: unknown) => (isNaN(Number(value)) ? 0 : Number(value));","import React from \"react\";\r\nimport { useUsers } from \"utils/user\";\r\nimport { IdSelect } from \"components/id-select\";\r\n\r\nexport const UserSelect = (props: React.ComponentProps<typeof IdSelect>) => {\r\n    const { data: users } = useUsers();\r\n    return <IdSelect options={users || []} {...props} />;\r\n};","import React from \"react\";\r\nimport {Form, Input} from \"antd\";\r\nimport {UserSelect} from \"components/user-select\";\r\nimport {Project} from \"../../types/project\";\r\nimport {User} from \"../../types/user\";\r\n\r\ninterface SearchPanelProps {\r\n    users: User[],\r\n    param: Partial<Pick<Project, 'name' | 'personId'>>\r\n    setParam:(param: SearchPanelProps['param']) => void\r\n}\r\n\r\nexport const SearchPanel = ({users ,param, setParam} :SearchPanelProps) => {\r\n    return <Form style={{marginBottom:'2rem'}} layout={\"inline\"}>\r\n        <Form.Item>\r\n            <Input placeholder={'项目名'} type=\"text\" value={param.name} onChange={evt => setParam({\r\n                    ...param,\r\n                    name: evt.target.value\r\n            })}/>\r\n        </Form.Item>\r\n        <Form.Item>\r\n            <UserSelect\r\n                defaultOptionName={\"负责人\"}\r\n                value={param.personId}\r\n                onChange={(value) =>\r\n                    setParam({\r\n                        ...param,\r\n                        personId: value,\r\n                    })\r\n                }\r\n            />\r\n        </Form.Item>\r\n    </Form>\r\n}","/**\r\n* 在本地对排序进行乐观更新\r\n* @param fromId 要排序的项目的id\r\n* @param type 'before' | 'after'\r\n* @param referenceId 参照id\r\n* @param list 要排序的列表, 比如tasks, kanbans\r\n*/\r\nexport const reorder = ({\r\n                            fromId,\r\n                            type,\r\n                            referenceId,\r\n                            list,\r\n                        }: {\r\n    list: { id: number }[];\r\n    fromId: number;\r\n    type: \"after\" | \"before\";\r\n    referenceId: number;\r\n}) => {\r\n    const copiedList = [...list];\r\n    // 找到fromId对应项目的下标\r\n    const movingItemIndex = copiedList.findIndex((item) => item.id === fromId);\r\n    if (!referenceId) {\r\n        return insertAfter([...copiedList], movingItemIndex, copiedList.length - 1);\r\n    }\r\n    const targetIndex = copiedList.findIndex((item) => item.id === referenceId);\r\n    const insert = type === \"after\" ? insertAfter : insertBefore;\r\n    return insert([...copiedList], movingItemIndex, targetIndex);\r\n};\r\n\r\n/**\r\n * 在list中，把from放在to的前边\r\n * @param list\r\n * @param from\r\n * @param to\r\n */\r\nconst insertBefore = (list: unknown[], from: number, to: number) => {\r\n    const toItem = list[to];\r\n    const removedItem = list.splice(from, 1)[0];\r\n    const toIndex = list.indexOf(toItem);\r\n    list.splice(toIndex, 0, removedItem);\r\n    return list;\r\n};\r\n\r\n/**\r\n * 在list中，把from放在to的后面\r\n * @param list\r\n * @param from\r\n * @param to\r\n */\r\nconst insertAfter = (list: unknown[], from: number, to: number) => {\r\n    const toItem = list[to];\r\n    const removedItem = list.splice(from, 1)[0];\r\n    const toIndex = list.indexOf(toItem);\r\n    list.splice(toIndex + 1, 0, removedItem);\r\n    return list;\r\n};","import { QueryKey, useQueryClient } from \"react-query\";\r\nimport {reorder} from \"./reorder\";\r\nimport {Task} from \"../types/task\";\r\n\r\nexport const useConfig = (\r\n    queryKey: QueryKey,\r\n    callback: (target: any, old?: any[]) => any[]\r\n) => {\r\n    const queryClient = useQueryClient();\r\n    return {\r\n        onSuccess: () => queryClient.invalidateQueries(queryKey),\r\n        async onMutate(target: any) {\r\n            const previousItems = queryClient.getQueryData(queryKey);\r\n            queryClient.setQueryData(queryKey, (old?: any[]) => {\r\n                return callback(target, old);\r\n            });\r\n            return { previousItems };\r\n        },\r\n        onError(error: any, newItem: any, context: any) {\r\n            queryClient.setQueryData(queryKey, context.previousItems);\r\n        },\r\n    };\r\n};\r\n\r\nexport const useDeleteConfig = (queryKey: QueryKey) =>\r\n    useConfig(\r\n        queryKey,\r\n        (target, old) => old?.filter((item) => item.id !== target.id) || []\r\n    );\r\nexport const useEditConfig = (queryKey: QueryKey) =>\r\n    useConfig(\r\n        queryKey,\r\n        (target, old) =>\r\n            old?.map((item) =>\r\n                item.id === target.id ? { ...item, ...target } : item\r\n            ) || []\r\n    );\r\nexport const useAddConfig = (queryKey: QueryKey) =>\r\n    useConfig(queryKey, (target, old) => (old ? [...old, target] : []));\r\n\r\nexport const useReorderKanbanConfig = (queryKey: QueryKey) =>\r\n    useConfig(queryKey, (target, old) => reorder({ list: old, ...target }));\r\n\r\nexport const useReorderTaskConfig = (queryKey: QueryKey) =>\r\n    useConfig(queryKey, (target, old) => {\r\n        const orderedList = reorder({ list: old, ...target }) as Task[];\r\n        return orderedList.map((item) =>\r\n            item.id === target.fromId\r\n                ? { ...item, kanbanId: target.toKanbanId }\r\n                : item\r\n        );\r\n    });","import { useHttp } from \"utils/http\";\r\nimport {QueryKey, useMutation, useQuery, useQueryClient} from \"react-query\";\r\nimport {useAddConfig, useDeleteConfig, useEditConfig} from \"./use-optimistic-opinion\";\r\nimport {Project} from \"../types/project\";\r\n\r\nexport const useProjects = (param?: Partial<Project>) => {\r\n    const client = useHttp();\r\n    return useQuery<Project[]>(['projects', param], () => client('projects', {data: param}))\r\n};\r\n\r\nexport const useEditProject = (queryKey: QueryKey) => {\r\n    const client = useHttp()\r\n    return useMutation((params: Partial<Project>) => client(`projects/${params.id}`, {\r\n        method: 'PATCH',  data:params,\r\n    }),\r\n        useEditConfig(queryKey)\r\n    )\r\n}\r\n\r\nexport const useAddProject = (queryKey: QueryKey) => {\r\n    const client = useHttp()\r\n    return useMutation((params: Partial<Project>) => client(`projects`, {\r\n            data:params,\r\n            method: 'POST',\r\n        }),\r\n        useAddConfig(queryKey)\r\n    )\r\n}\r\n\r\nexport const useDeleteProject = (queryKey: QueryKey) => {\r\n    const client = useHttp()\r\n    return useMutation(({id} : {id: number}) => client(`projects${id}`, {\r\n            method: 'DELETE',\r\n        }),\r\n        useDeleteConfig(queryKey)\r\n    )\r\n}\r\n\r\nexport const useProject = (id?: number) => {\r\n    const client = useHttp();\r\n    return useQuery<Project>(\r\n        [\"project\", { id }],\r\n        () => client(`projects/${id}`),\r\n        {\r\n            enabled: Boolean(id),\r\n        }\r\n    );\r\n};","import React from 'react'\r\nimport {Rate} from 'antd'\r\n\r\ninterface PinProps extends  React.ComponentProps<typeof Rate> {\r\n    checked: boolean;\r\n    onCheckedChange?: (checked: boolean) => void\r\n}\r\n\r\nexport const Pin = ({checked, onCheckedChange, ...restProps}: PinProps) => {\r\n    return <Rate\r\n        count={1}\r\n        value={checked ? 1: 0}\r\n        onChange={num => onCheckedChange?.(!!num)}\r\n        {...restProps}\r\n    />\r\n}","import { URLSearchParamsInit, useSearchParams } from \"react-router-dom\";\r\nimport {useMemo, useState} from \"react\";\r\nimport { cleanObject, subset} from \"./index\";\r\n\r\n/**\r\n * 返回页面url中，指定键的参数值\r\n */\r\nexport const useUrlQueryParam = <K extends string>(keys: K[]) => {\r\n    const [searchParams] = useSearchParams();\r\n    const setSearchParams = useSetUrlSearchParam();\r\n    const [stateKeys] = useState(keys);\r\n    return [\r\n        useMemo(\r\n            () =>\r\n                subset(Object.fromEntries(searchParams), keys) as {\r\n                    [key in K]: string;\r\n                },\r\n            // eslint-disable-next-line react-hooks/exhaustive-deps\r\n            [searchParams, stateKeys]\r\n        ),\r\n        (params: Partial<{ [key in K]: unknown }>) => {\r\n           return setSearchParams(params)\r\n        },\r\n    ]as const;\r\n};\r\n\r\nexport const  useSetUrlSearchParam = () => {\r\n    const [searchParams, setSearchParam] = useSearchParams();\r\n    return (params: Partial<{ [key in string]: unknown }>) => {\r\n        // iterator\r\n        // iterator: https://codesandbox.io/s/upbeat-wood-bum3j?file=/src/index.js\r\n        const o = cleanObject({\r\n            ...Object.fromEntries(searchParams),\r\n            ...params,\r\n        }) as URLSearchParamsInit;\r\n        return setSearchParam(o);\r\n    }\r\n}\r\n\r\n","import {useSetUrlSearchParam, useUrlQueryParam} from \"utils/url\";\r\nimport {useMemo} from \"react\";\r\nimport {useProject} from \"../../utils/project\";\r\n\r\n// 项目列表搜索的参数\r\nexport const useProjectsSearchParams = () => {\r\n    const [param, setParam] = useUrlQueryParam([\"name\", \"personId\"]);\r\n    return [\r\n        useMemo(\r\n            () => ({ ...param, personId: Number(param.personId) || undefined }),\r\n            [param]\r\n        ),\r\n        setParam,\r\n    ] as const;\r\n};\r\nexport const useProjectsQueryKey = () => {\r\n    const [params] = useProjectsSearchParams()\r\n    return ['projects', params]}\r\n//全局状态管理器\r\nexport const useProjectModal = () => {\r\n    const [{projectCreate}, setProjectCreate] = useUrlQueryParam([\r\n        'projectCreate'\r\n    ])\r\n    const [{editingProjectId}, setEditingProjectId] = useUrlQueryParam([\r\n        'editingProjectId'\r\n    ])\r\n    const  setUrlParams = useSetUrlSearchParam()\r\n    const {data: editingProject, isLoading} = useProject(Number(editingProjectId))\r\n    const open = () => setProjectCreate({projectCreate: true})\r\n    const close = () => setUrlParams({ projectCreate: \"\", editingProjectId: \"\" })\r\n    const startEdit = (id: number) => setEditingProjectId({editingProjectId: id})\r\n\r\n    return {\r\n        projectModalOpen: projectCreate === 'true' || Boolean(editingProjectId),\r\n        open,\r\n        close,\r\n        startEdit,\r\n        editingProject,\r\n        isLoading,\r\n    }\r\n}\r\n\r\n","import React from \"react\";\r\nimport {Dropdown, Menu, Modal, Table} from \"antd\";\r\nimport dayjs from \"dayjs\";\r\nimport {TableProps} from \"antd/es/table\";\r\nimport {Link} from \"react-router-dom\";\r\nimport {useDeleteProject, useEditProject} from \"../../utils/project\";\r\nimport {Pin} from \"../../components/pin\";\r\nimport {ButtonNoPadding} from \"../../components/lib\";\r\nimport {useProjectModal, useProjectsQueryKey} from \"./util\";\r\nimport {Project} from \"../../types/project\";\r\nimport {User} from \"../../types/user\";\r\n\r\ninterface ListProps extends TableProps<Project> {\r\n    users: User[];\r\n}\r\n\r\nexport const List = ({ users, ...props }: ListProps) => {\r\n    const {mutate} = useEditProject(useProjectsQueryKey())\r\n    const pinProject = (id: number) => (pin: boolean) => mutate({id, pin})\r\n\r\n    return (\r\n        <Table\r\n            rowKey={\"id\"}\r\n            pagination={false}\r\n            columns={[\r\n                {\r\n                    title: <Pin checked={true} disabled={true}/>,\r\n                    render(value, project) {\r\n                        return <Pin\r\n                                checked={project.pin}\r\n                                onCheckedChange={pinProject(project.id)}\r\n                        />\r\n                    }\r\n                },\r\n                {\r\n                    title: \"名称\",\r\n                    sorter: (a, b) => a.name.localeCompare(b.name),\r\n                    render(value, project) {\r\n                        return <Link to={String(project.id)}>{project.name}</Link>;\r\n                    }\r\n                },\r\n                {\r\n                    title: \"部门\",\r\n                    dataIndex: \"organization\",\r\n                },\r\n                {\r\n                    title: \"负责人\",\r\n                    render(value, project) {\r\n                        return (\r\n                            <span>\r\n                {users.find((user) => user.id === project.personId)?.name ||\r\n                \"未知\"}\r\n              </span>\r\n                        );\r\n                    },\r\n                },\r\n                {\r\n                    title: \"创建时间\",\r\n                    render(value, project) {\r\n                        return (\r\n                            <span>\r\n                {project.created\r\n                    ? dayjs(project.created).format(\"YYYY-MM-DD\")\r\n                    : \"无\"}\r\n              </span>\r\n                        );\r\n                    },\r\n                },\r\n                {\r\n                    render(value, project) {\r\n                        return <More project={project}/>\r\n                    }\r\n\r\n                }\r\n            ]}\r\n            {...props}\r\n        />\r\n    );\r\n};\r\n\r\nconst More = ({project} : { project: Project}) => {\r\n    const {startEdit} = useProjectModal()\r\n    const editProject = (id: number) => () => startEdit(id);\r\n    const {mutate: deleteProject} = useDeleteProject(useProjectsQueryKey())\r\n    const confirmDeleteProject = (id: number) => {\r\n        Modal.confirm({\r\n            title: '确定删除吗？',\r\n            content: '点击确定删除',\r\n            onOk() {\r\n                deleteProject({id})\r\n            }\r\n        })\r\n    }\r\n    return <Dropdown\r\n        overlay= {\r\n            <Menu>\r\n                <Menu.Item onClick = {editProject(project.id)} key={\"edit\"}>编辑</Menu.Item>\r\n                <Menu.Item onClick = {() => confirmDeleteProject(project.id)}key={\"delete\"}>删除</Menu.Item>\r\n            </Menu>}>\r\n        <ButtonNoPadding type={\"link\"}>...</ButtonNoPadding>\r\n    </Dropdown>\r\n}","import React from \"react\";\r\nimport { SearchPanel } from \"screens/project-list/search-panel\";\r\nimport { List } from \"screens/project-list/list\";\r\nimport {useDebounce, useDocumentTitle} from \"../../utils\";\r\nimport { useProjects } from \"utils/project\";\r\nimport { useUsers } from \"utils/user\";\r\nimport {useUrlQueryParam} from \"../../utils/url\";\r\nimport {useProjectModal, useProjectsSearchParams} from \"./util\";\r\nimport {ButtonNoPadding, ErrorBox, Row, ScreenContainer} from \"../../components/lib\";\r\n\r\n// 使用 JS ，大部分的错误都是在 runtime(运行时) 的时候发现的\r\n// 我们希望，在静态代码中，就能找到其中的一些错误 -> 强类型\r\nexport const ProjectListScreen = () => {\r\n    useDocumentTitle(\"项目列表\", false);\r\n    const [param, setParam] = useProjectsSearchParams()\r\n    const {open} = useProjectModal()\r\n    const { isLoading, error, data: list } = useProjects(useDebounce(param, 200));\r\n    const { data: users } = useUsers();\r\n\r\n    useUrlQueryParam([''])\r\n    return (\r\n        <ScreenContainer>\r\n            <Row between={true}>\r\n                <h1>项目列表</h1>\r\n                <ButtonNoPadding onClick={open} type={\"link\"}>创建项目</ButtonNoPadding>\r\n            </Row>\r\n            <SearchPanel users={users || []} param={param} setParam={setParam} />\r\n            <ErrorBox error={error}/>\r\n            <List  loading={isLoading} users={users || []} dataSource={list || []} />\r\n        </ScreenContainer>\r\n    );\r\n};\r\n","import {useHttp} from \"./http\";\r\nimport {QueryKey, useMutation, useQuery} from \"react-query\";\r\nimport {Kanban} from \"../types/kanban\";\r\nimport {useAddConfig, useDeleteConfig,  useReorderKanbanConfig} from \"./use-optimistic-opinion\";\r\n\r\nexport const useKanbans = (param?: Partial<Kanban>) => {\r\n    const client = useHttp();\r\n    return useQuery<Kanban[]>(['kanbans', param], () => client('kanbans', {data: param}))\r\n};\r\n\r\nexport const useAddKanban = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n\r\n    return useMutation(\r\n        (params: Partial<Kanban>) =>\r\n            client(`kanbans`, {\r\n                data: params,\r\n                method: \"POST\",\r\n            }),\r\n        useAddConfig(queryKey)\r\n    );\r\n};\r\n\r\nexport const useDeleteKanban = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n\r\n    return useMutation(\r\n        ({ id }: { id: number }) =>\r\n            client(`kanbans/${id}`, {\r\n                method: \"DELETE\",\r\n            }),\r\n        useDeleteConfig(queryKey)\r\n    );\r\n};\r\n\r\nexport interface SortProps {\r\n    // 要重新排序的 item\r\n    fromId: number;\r\n    // 目标 item\r\n    referenceId: number;\r\n    // 放在目标item的前还是后\r\n    type: \"before\" | \"after\";\r\n    fromKanbanId?: number;\r\n    toKanbanId?: number;\r\n}\r\n\r\nexport const useReorderKanban = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation((params: SortProps) => {\r\n        return client(\"kanbans/reorder\", {\r\n            data: params,\r\n            method: \"POST\",\r\n        });\r\n    }, useReorderKanbanConfig(queryKey));\r\n};","import {useHttp} from \"./http\";\r\nimport {QueryKey, useMutation, useQuery} from \"react-query\";\r\nimport {Task} from \"../types/task\";\r\nimport {\r\n    useAddConfig,\r\n    useDeleteConfig,\r\n    useEditConfig,\r\n    useReorderTaskConfig\r\n} from \"./use-optimistic-opinion\";\r\nimport {Project} from \"../types/project\";\r\nimport {SortProps} from \"./kanban\";\r\n\r\nexport const useTasks = (param?: Partial<Task>) => {\r\n    const client = useHttp();\r\n    return useQuery<Task[]>(['tasks', param], () => client('tasks', {data: param}))\r\n};\r\n\r\nexport const useAddTask = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n\r\n    return useMutation(\r\n        (params: Partial<Task>) =>\r\n            client(`tasks`, {\r\n                data: params,\r\n                method: \"POST\",\r\n            }),\r\n        useAddConfig(queryKey)\r\n    );\r\n};\r\n\r\nexport const useTask = (id?: number) => {\r\n    const client = useHttp()\r\n    return useQuery<Project>(\r\n        [\"project\", {id}],\r\n        () => client(`projects/${id}`),\r\n    {\r\n        enabled: Boolean(id),\r\n    }\r\n    )\r\n}\r\n\r\nexport const useEditTask = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation(\r\n        (params: Partial<Task>) =>\r\n            client(`tasks/${params.id}`, {\r\n                method: \"PATCH\",\r\n                data: params,\r\n            }),\r\n        useEditConfig(queryKey)\r\n    );\r\n};\r\n\r\nexport const useDeleteTask = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n\r\n    return useMutation(\r\n        ({ id }: { id: number }) =>\r\n            client(`tasks/${id}`, {\r\n                method: \"DELETE\",\r\n            }),\r\n        useDeleteConfig(queryKey)\r\n    );\r\n};\r\n\r\nexport const useReorderTask = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation((params: SortProps) => {\r\n        return client(\"tasks/reorder\", {\r\n            data: params,\r\n            method: \"POST\",\r\n        });\r\n    },  useReorderTaskConfig(queryKey));\r\n};","import {useLocation} from \"react-router\";\r\nimport {useCallback, useMemo} from \"react\"\r\nimport {useProject} from \"../../utils/project\";\r\nimport {useUrlQueryParam} from \"../../utils/url\";\r\nimport {useTask} from \"../../utils/task\";\r\nimport {useDebounce} from \"../../utils\";\r\n\r\nexport const useProjectIdInUrl = () => {\r\n    const {pathname} = useLocation()\r\n    const id = pathname.match(/projects\\/(d+)/)?.[1]\r\n    return Number(id)\r\n}\r\n\r\nexport const useProjectInUrl = () => useProject(useProjectIdInUrl())\r\n\r\nexport const useKanbanSearchParams = () => ({\r\n    projectId: useProjectIdInUrl()\r\n})\r\n\r\nexport const useKanbansQueryKey = () => ['kanbans', useKanbanSearchParams()]\r\n\r\nexport const useTasksSearchParams = () => {\r\n    const [param, setParam] = useUrlQueryParam([\r\n        'name',\r\n        'typeId',\r\n        'processorId',\r\n        'tagId'\r\n    ])\r\n    const projectId = useProjectIdInUrl()\r\n    const debounceName = useDebounce(param.name, 200)\r\n    return useMemo(() => ({\r\n        projectId,\r\n        typeId: Number(param.typeId) || undefined,\r\n        processorId: Number(param.processorId) || undefined,\r\n        tagId: Number(param.tagId) || undefined,\r\n        name: debounceName,\r\n    }), [projectId, debounceName])\r\n}\r\n\r\nexport const useTasksQueryKey = () =>['tasks', useTasksSearchParams()]\r\n\r\nexport const useTasksModal = () => {\r\n    const [{editingTaskId}, setEditingTaskId] = useUrlQueryParam(['editingTaskId'])\r\n    const {data: editingTask, isLoading} = useTask(Number(editingTaskId))\r\n    const startEdit = useCallback((id: number) => {\r\n        setEditingTaskId({editingTaskId: id})\r\n    }, [setEditingTaskId])\r\n    const close = useCallback(() => {\r\n        setEditingTaskId({editingTaskId: ''})\r\n    }, [setEditingTaskId])\r\n    return {\r\n        editingTaskId,\r\n        editingTask,\r\n        startEdit,\r\n        close,\r\n        isLoading\r\n    }\r\n}\r\n\r\n","import {useHttp} from \"./http\";\r\nimport {useQuery} from \"react-query\";\r\nimport {TaskType} from \"../types/task-type\";\r\n\r\nexport const useTaskTypes = () => {\r\n    const client = useHttp();\r\n    return useQuery<TaskType[]>([\"taskType\"], () =>\r\n        client(\"taskTypes\",)\r\n    )\r\n};","export default __webpack_public_path__ + \"static/media/task.1da9b0fd.svg\";","export default __webpack_public_path__ + \"static/media/bug.61d2d6fe.svg\";","import React, {useEffect, useState} from 'react'\r\nimport {useProjectIdInUrl, useTasksQueryKey} from \"./util\";\r\nimport {useAddTask} from \"../../utils/task\";\r\nimport {Card, Input} from \"antd\";\r\n\r\nexport const CreateTask = ({ kanbanId }: { kanbanId: number }) => {\r\n    const [name, setName] = useState(\"\");\r\n    const { mutateAsync: addTask } = useAddTask(useTasksQueryKey());\r\n    const projectId = useProjectIdInUrl();\r\n    const [inputMode, setInputMode] = useState(false);\r\n\r\n    const submit = async () => {\r\n        await addTask({ projectId, name, kanbanId });\r\n        setInputMode(false);\r\n        setName(\"\");\r\n    };\r\n\r\n    const toggle = () => setInputMode((mode) => !mode);\r\n\r\n    useEffect(() => {\r\n        if (!inputMode) {\r\n            setName(\"\");\r\n        }\r\n    }, [inputMode]);\r\n\r\n    if (!inputMode) {\r\n        return <div onClick={toggle}>+创建事务</div>;\r\n    }\r\n\r\n    return (\r\n        <Card>\r\n            <Input\r\n                onBlur={toggle}\r\n                placeholder={\"需要做些什么\"}\r\n                autoFocus={true}\r\n                onPressEnter={submit}\r\n                value={name}\r\n                onChange={(evt) => setName(evt.target.value)}\r\n            />\r\n        </Card>\r\n    );\r\n};","import React from \"react\";\r\n\r\nexport const Mark = ({ name, keyword }: { name: string; keyword: string }) => {\r\n    if (!keyword) {\r\n        return <>{name}</>;\r\n    }\r\n    const arr = name.split(keyword);\r\n    return (\r\n        <>\r\n            {arr.map((str, index) => (\r\n                <span key={index}>\r\n          {str}\r\n                    {index === arr.length - 1 ? null : (\r\n                        <span style={{ color: \"#257AFD\" }}>{keyword}</span>\r\n                    )}\r\n        </span>\r\n            ))}\r\n        </>\r\n    );\r\n};","import React, { ReactNode } from \"react\";\r\nimport {\r\n    Draggable,\r\n    DraggableProps,\r\n    Droppable,\r\n    DroppableProps,\r\n    DroppableProvided,\r\n    DroppableProvidedProps,\r\n} from \"react-beautiful-dnd\";\r\n\r\ntype DropProps = Omit<DroppableProps, \"children\"> & { children: ReactNode };\r\n\r\nexport const Drop = ({ children, ...props }: DropProps) => {\r\n    return (\r\n        <Droppable {...props}>\r\n            {(provided) => {\r\n                if (React.isValidElement(children)) {\r\n                    return React.cloneElement(children, {\r\n                        ...provided.droppableProps,\r\n                        ref: provided.innerRef,\r\n                        provided,\r\n                    });\r\n                }\r\n                return <div />;\r\n            }}\r\n        </Droppable>\r\n    );\r\n};\r\n\r\ntype DropChildProps = Partial<\r\n    { provided: DroppableProvided } & DroppableProvidedProps\r\n    > &\r\n    React.HTMLAttributes<HTMLDivElement>;\r\n\r\nexport const DropChild = React.forwardRef<HTMLDivElement, DropChildProps>(\r\n    ({ children, ...props }, ref) => (\r\n        <div ref={ref} {...props}>\r\n            {children}\r\n            {props.provided?.placeholder}\r\n        </div>\r\n    )\r\n);\r\n\r\ntype DragProps = Omit<DraggableProps, \"children\"> & { children: ReactNode };\r\n\r\nexport const Drag = ({ children, ...props }: DragProps) => {\r\n    return (\r\n        <Draggable {...props}>\r\n            {(provided) => {\r\n                if (React.isValidElement(children)) {\r\n                    return React.cloneElement(children, {\r\n                        ...provided.draggableProps,\r\n                        ...provided.dragHandleProps,\r\n                        ref: provided.innerRef,\r\n                    });\r\n                }\r\n                return <div />;\r\n            }}\r\n        </Draggable>\r\n    );\r\n};","import React from \"react\";\r\nimport { Kanban } from \"types/kanban\";\r\nimport {useTasks} from \"../../utils/task\";\r\nimport {useKanbansQueryKey, useTasksModal, useTasksSearchParams} from \"./util\";\r\nimport {useTaskTypes} from \"../../utils/task-type\";\r\nimport taskIcon from \"../../assets/task.svg\"\r\nimport bugIcon from \"../../assets/bug.svg\"\r\nimport styled from \"@emotion/styled\";\r\nimport {Button, Card, Dropdown, Menu, Modal} from \"antd\";\r\nimport {CreateTask} from \"./create-task\";\r\nimport {Task} from \"../../types/task\";\r\nimport {Mark} from \"../../components/mark\";\r\nimport {useDeleteKanban} from \"../../utils/kanban\";\r\nimport {Row} from \"../../components/lib\";\r\nimport {Drag, Drop, DropChild} from \"../../components/drag-and-drop\";\r\n\r\nconst TaskTypeIcon = ({id}: {id:number}) => {\r\n    const {data: taskTypes} = useTaskTypes()\r\n    const name = taskTypes?.find((taskType) => taskType.id === id)?.name\r\n    if(!name) {\r\n        return null\r\n    }\r\n    return <img alt={'task-icon'} src={name === 'task' ? taskIcon: bugIcon}/>\r\n}\r\n\r\nconst TaskCard = ({ task }: { task: Task }) => {\r\n    const { startEdit } = useTasksModal();\r\n    const { name: keyword } = useTasksSearchParams();\r\n    return (\r\n        <Card\r\n            onClick={() => startEdit(task.id)}\r\n            style={{ marginBottom: \"0.5rem\", cursor: \"pointer\" }}\r\n            key={task.id}\r\n        >\r\n            <p>\r\n                <Mark keyword={keyword} name={task.name} />\r\n            </p>\r\n            <TaskTypeIcon id={task.typeId} />\r\n        </Card>\r\n    );\r\n};\r\n\r\nexport const KanbanColumn = React.forwardRef<\r\n    HTMLDivElement,\r\n    { kanban: Kanban }\r\n    >(({ kanban, ...props }, ref) => {\r\n    const { data: allTasks } = useTasks(useTasksSearchParams());\r\n    const tasks = allTasks?.filter((task) => task.kanbanId === kanban.id);\r\n    return (\r\n        <Container {...props} ref={ref}>\r\n            <Row between={true}>\r\n                <h3>{kanban.name}</h3>\r\n                <More kanban={kanban} key={kanban.id} />\r\n            </Row>\r\n            <TasksContainer>\r\n                <Drop\r\n                    type={\"ROW\"}\r\n                    direction={\"vertical\"}\r\n                    droppableId={String(kanban.id)}\r\n                >\r\n                    <DropChild>\r\n                        {tasks?.map((task, taskIndex) => (\r\n                            <Drag\r\n                                key={task.id}\r\n                                index={taskIndex}\r\n                                draggableId={\"task\" + task.id}\r\n                            >\r\n                                <div>\r\n                                    <TaskCard key={task.id} task={task} />\r\n                                </div>\r\n                            </Drag>\r\n                        ))}\r\n                    </DropChild>\r\n                </Drop>\r\n                <CreateTask kanbanId={kanban.id} />\r\n            </TasksContainer>\r\n        </Container>\r\n    );\r\n});\r\n\r\n\r\nconst More = ({ kanban }: { kanban: Kanban }) => {\r\n    const { mutateAsync } = useDeleteKanban(useKanbansQueryKey());\r\n    const startDelete = () => {\r\n        Modal.confirm({\r\n            okText: \"确定\",\r\n            cancelText: \"取消\",\r\n            title: \"确定删除看板吗\",\r\n            onOk() {\r\n                return mutateAsync({ id: kanban.id });\r\n            },\r\n        });\r\n    };\r\n    const overlay = (\r\n        <Menu>\r\n            <Menu.Item>\r\n                <Button type={\"link\"} onClick={startDelete}>\r\n                    删除\r\n                </Button>\r\n            </Menu.Item>\r\n\r\n        </Menu>\r\n    );\r\n    return (\r\n        <Dropdown overlay={overlay}>\r\n            <Button type={\"link\"}>...</Button>\r\n        </Dropdown>\r\n    );\r\n};\r\n\r\nexport const Container = styled.div`\r\n  min-width: 27rem;\r\n  border-radius: 6px;\r\n  background-color: rgb(244,245,247);\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 0.7rem 0.7rem 0.7rem;\r\n  margin-right: 1.5rem;\r\n  `\r\n\r\nconst TasksContainer = styled.div`\r\n  overflow: scroll;\r\n  flex: 1;\r\n\r\n  ::-webkit-scrollbar {\r\n    display: none;\r\n  }\r\n`;","import React from \"react\";\r\nimport { IdSelect } from \"components/id-select\";\r\nimport {useTaskTypes} from \"../utils/task-type\";\r\n\r\nexport const TaskTypeSelect = (props: React.ComponentProps<typeof IdSelect>) => {\r\n    const {data: taskTypes} = useTaskTypes()\r\n    return <IdSelect options={taskTypes || []} {...props} />;\r\n};","import React from \"react\";\r\nimport {useTasksSearchParams} from \"./util\";\r\nimport {useSetUrlSearchParam} from \"../../utils/url\";\r\nimport {Row} from \"../../components/lib\";\r\nimport {Button, Input} from \"antd\";\r\nimport {UserSelect} from \"../../components/user-select\";\r\nimport {TaskTypeSelect} from \"../../components/task-type-select\";\r\n\r\nexport const SearchPanel = () => {\r\n    const searchParams = useTasksSearchParams()\r\n    const setSearchParams = useSetUrlSearchParam()\r\n    const reset = () => {\r\n        setSearchParams({\r\n            typeId: undefined,\r\n            processorId: undefined,\r\n            tagId: undefined,\r\n            name: undefined\r\n        })\r\n    }\r\n\r\n    return <Row marginBottom={4} gap={true}>\r\n    <Input style={{width: '20rem'}} placeholder={'人物名'} value={setSearchParams.name}\r\n           onChange={evt => setSearchParams({name: evt.target.value})}/>\r\n           <UserSelect defaultOptionName={'经办人'} value={searchParams.processorId} onChange={value => setSearchParams({processorId: value})}/>\r\n           <TaskTypeSelect defaultOptionName={'类型'} value={searchParams.typeId}\r\n                            onChange={value => setSearchParams({typeId: value})}/>\r\n                            <Button onClick={reset}>Clear filter</Button>\r\n    </Row>\r\n}","import React from \"react\";\r\nimport {useKanbansQueryKey, useProjectIdInUrl} from \"./util\";\r\nimport {useState} from \"react\";\r\nimport {useAddKanban} from \"../../utils/kanban\";\r\nimport {Input} from \"antd\";\r\nimport {Container} from \"./kanban-column\";\r\n\r\nexport const CreateKanban = () => {\r\n    const [name, setName] = useState('')\r\n    const projectId = useProjectIdInUrl()\r\n    const {mutateAsync: addKanban} = useAddKanban(useKanbansQueryKey())\r\n\r\n    const submit = async () => {\r\n        await addKanban({name, projectId})\r\n        setName('')\r\n    }\r\n    return <Container>\r\n        <Input size={\"large\"} placeholder={'新建看板名称'} onPressEnter={submit} value={name} onChange={evt => setName(evt.target.value)}/>\r\n    </Container>\r\n}","import React, {useEffect} from 'react';\r\nimport {useTasksModal, useTasksQueryKey} from \"./util\";\r\nimport {useDeleteTask, useEditTask} from \"../../utils/task\";\r\nimport {Button, Form, Input, Modal} from \"antd\";\r\nimport {TaskTypeSelect} from \"../../components/task-type-select\";\r\nimport {UserSelect} from \"../../components/user-select\";\r\n\r\nconst layout = {\r\n    labelCol: {span: 8},\r\n    wrapper: {span: 16},\r\n}\r\n\r\nexport const TaskModal = () => {\r\n    const [form] = Form.useForm()\r\n    const {editingTaskId, editingTask, close} = useTasksModal()\r\n    const {mutateAsync: editTask, isLoading: editLoading} = useEditTask(useTasksQueryKey())\r\n    const { mutate: deleteTask } = useDeleteTask(useTasksQueryKey());\r\n\r\n    const onCancel = () => {\r\n        close()\r\n        form.resetFields()\r\n    }\r\n\r\n    const onOk = async () => {\r\n        await editTask({...editingTask, ...form.getFieldsValue()})\r\n        close()\r\n    }\r\n\r\n    const startDelete = () => {\r\n        close();\r\n        Modal.confirm({\r\n            okText: \"确定\",\r\n            cancelText: \"取消\",\r\n            title: \"确定删除任务吗\",\r\n            onOk() {\r\n                return deleteTask({ id: Number(editingTaskId) });\r\n            },\r\n        });\r\n    };\r\n\r\n    useEffect(() => {\r\n        form.setFieldsValue(editingTask)\r\n    }, [form, editingTask])\r\n\r\n    return (\r\n        <Modal\r\n            forceRender={true}\r\n            onCancel={onCancel}\r\n            onOk={onOk}\r\n            okText={\"确认\"}\r\n            cancelText={\"取消\"}\r\n            confirmLoading={editLoading}\r\n            title={\"编辑任务\"}\r\n            visible={!!editingTaskId}\r\n        >\r\n            <Form {...layout} initialValues={editingTask} form={form}>\r\n                <Form.Item\r\n                    label={\"任务名\"}\r\n                    name={\"name\"}\r\n                    rules={[{ required: true, message: \"请输入任务名\" }]}\r\n                >\r\n                    <Input />\r\n                </Form.Item>\r\n                <Form.Item label={\"经办人\"} name={\"processorId\"}>\r\n                    <UserSelect defaultOptionName={\"经办人\"} />\r\n                </Form.Item>\r\n                <Form.Item label={\"类型\"} name={\"typeId\"}>\r\n                    <TaskTypeSelect />\r\n                </Form.Item>\r\n            </Form>\r\n            <div style={{ textAlign: \"right\" }}>\r\n                <Button\r\n                    onClick={startDelete}\r\n                    style={{ fontSize: \"14px\" }}\r\n                    size={\"small\"}\r\n                >\r\n                    删除\r\n                </Button>\r\n            </div>\r\n        </Modal>\r\n    )\r\n}","import React, {useCallback} from \"react\";\r\nimport {useDocumentTitle} from \"../../utils\";\r\nimport {useKanbans, useReorderKanban} from \"../../utils/kanban\";\r\nimport {\r\n    useKanbanSearchParams,\r\n    useKanbansQueryKey,\r\n    useProjectInUrl,\r\n    useTasksQueryKey,\r\n    useTasksSearchParams\r\n} from \"./util\";\r\nimport {KanbanColumn} from \"./kanban-column\";\r\nimport styled from \"@emotion/styled\";\r\nimport {SearchPanel} from \"./search-panel\";\r\nimport { ScreenContainer } from \"components/lib\";\r\nimport {useReorderTask, useTasks} from \"../../utils/task\";\r\nimport {Spin} from \"antd\";\r\nimport {CreateKanban} from \"./create-kanban\";\r\nimport {TaskModal} from \"./task-modal\";\r\nimport {DragDropContext, DropResult} from \"react-beautiful-dnd\";\r\nimport {Drag, Drop, DropChild} from \"../../components/drag-and-drop\";\r\n\r\n\r\nexport const KanbanScreen = () => {\r\n    useDocumentTitle('看板列表')\r\n    const {data: currentProject} = useProjectInUrl()\r\n    const {data: kanbans = [], isLoading: kanbanIsLoading} = useKanbans(useKanbanSearchParams())\r\n    const {isLoading: taskIsLoading} = useTasks(useTasksSearchParams())\r\n    const isLoading = taskIsLoading || kanbanIsLoading\r\n\r\n    const onDragEnd = useDragEnd();\r\n    return (\r\n        <DragDropContext onDragEnd={onDragEnd}>\r\n            <ScreenContainer>\r\n                <h1>{currentProject?.name}看板</h1>\r\n                <SearchPanel />\r\n                {isLoading ? (\r\n                    <Spin size={\"large\"} />\r\n                ) : (\r\n                    <ColumnsContainer>\r\n                        <Drop\r\n                            type={\"COLUMN\"}\r\n                            direction={\"horizontal\"}\r\n                            droppableId={\"kanban\"}\r\n                        >\r\n                            <DropChild style={{ display: \"flex\" }}>\r\n                                {kanbans?.map((kanban, index) => (\r\n                                    <Drag\r\n                                        key={kanban.id}\r\n                                        draggableId={\"kanban\" + kanban.id}\r\n                                        index={index}\r\n                                    >\r\n                                        <KanbanColumn kanban={kanban} key={kanban.id} />\r\n                                    </Drag>\r\n                                ))}\r\n                            </DropChild>\r\n                        </Drop>\r\n                        <CreateKanban />\r\n                    </ColumnsContainer>\r\n                )}\r\n                <TaskModal />\r\n            </ScreenContainer>\r\n        </DragDropContext>\r\n    );\r\n}\r\n\r\nexport const useDragEnd = () => {\r\n    const { data: kanbans } = useKanbans(useKanbanSearchParams());\r\n    const { mutate: reorderKanban } = useReorderKanban(useKanbansQueryKey());\r\n    const { mutate: reorderTask } = useReorderTask(useTasksQueryKey());\r\n    const { data: allTasks = [] } = useTasks(useTasksSearchParams());\r\n    return useCallback(\r\n        ({ source, destination, type }: DropResult) => {\r\n            if (!destination) {\r\n                return;\r\n            }\r\n            // 看板排序\r\n            if (type === \"COLUMN\") {\r\n                const fromId = kanbans?.[source.index].id;\r\n                const toId = kanbans?.[destination.index].id;\r\n                if (!fromId || !toId || fromId === toId) {\r\n                    return;\r\n                }\r\n                const type = destination.index > source.index ? \"after\" : \"before\";\r\n                reorderKanban({ fromId, referenceId: toId, type });\r\n            }\r\n            if (type === \"ROW\") {\r\n                const fromKanbanId = +source.droppableId;\r\n                const toKanbanId = +destination.droppableId;\r\n                if (fromKanbanId === toKanbanId) {\r\n                    return;\r\n                }\r\n                const fromTask = allTasks.filter(\r\n                    (task) => task.kanbanId === fromKanbanId\r\n                )[source.index];\r\n                const toTask = allTasks.filter((task) => task.kanbanId === toKanbanId)[\r\n                    destination.index\r\n                    ];\r\n                if (fromTask?.id === toTask?.id) {\r\n                    return;\r\n                }\r\n                reorderTask({\r\n                    fromId: fromTask?.id,\r\n                    referenceId: toTask?.id,\r\n                    fromKanbanId,\r\n                    toKanbanId,\r\n                    type:\r\n                        fromKanbanId === toKanbanId && destination.index > source.index\r\n                            ? \"after\"\r\n                            : \"before\",\r\n                });\r\n            }\r\n        },\r\n        [kanbans, reorderKanban, allTasks, reorderTask]\r\n    );\r\n};\r\n\r\nexport const ColumnsContainer = styled.div `\r\n  display: flex;\r\n  overflow-x: scroll;\r\n`\r\n\r\n","import { useProjectIdInUrl } from \"screens/kanban/util\";\r\n\r\nexport const useEpicSearchParams = () => ({ projectId: useProjectIdInUrl() });\r\n\r\nexport const useEpicsQueryKey = () => [\"epics\", useEpicSearchParams()];","import React, { useEffect } from \"react\";\r\nimport { Button, Drawer, Form, Input, Spin } from \"antd\";\r\nimport { DrawerProps } from \"antd/es/drawer\";\r\nimport styled from \"@emotion/styled\";\r\nimport { ErrorBox } from \"components/lib\";\r\nimport { useAddEpic } from \"utils/epic\";\r\nimport { useEpicsQueryKey } from \"screens/epic/util\";\r\nimport { useProjectIdInUrl } from \"screens/kanban/util\";\r\n\r\nexport const CreateEpic = (\r\n    props: Pick<DrawerProps, \"visible\"> & { onClose: () => void }\r\n) => {\r\n    const { mutate: addEpic, isLoading, error } = useAddEpic(useEpicsQueryKey());\r\n    const [form] = Form.useForm();\r\n    const projectId = useProjectIdInUrl();\r\n\r\n    const onFinish = async (values: any) => {\r\n        await addEpic({ ...values, projectId });\r\n        props.onClose();\r\n    };\r\n\r\n    useEffect(() => {\r\n        form.resetFields();\r\n    }, [form, props.visible]);\r\n\r\n    return (\r\n        <Drawer\r\n            visible={props.visible}\r\n            onClose={props.onClose}\r\n            forceRender={true}\r\n            destroyOnClose={true}\r\n            width={\"100%\"}\r\n        >\r\n            <Container>\r\n                {isLoading ? (\r\n                    <Spin size={\"large\"} />\r\n                ) : (\r\n                    <>\r\n                        <h1>创建任务组</h1>\r\n                        <ErrorBox error={error} />\r\n                        <Form\r\n                            form={form}\r\n                            layout={\"vertical\"}\r\n                            style={{ width: \"40rem\" }}\r\n                            onFinish={onFinish}\r\n                        >\r\n                            <Form.Item\r\n                                label={\"名称\"}\r\n                                name={\"name\"}\r\n                                rules={[{ required: true, message: \"请输入任务组名\" }]}\r\n                            >\r\n                                <Input placeholder={\"请输入任务组名称\"} />\r\n                            </Form.Item>\r\n\r\n                            <Form.Item style={{ textAlign: \"right\" }}>\r\n                                <Button\r\n                                    loading={isLoading}\r\n                                    type={\"primary\"}\r\n                                    htmlType={\"submit\"}\r\n                                >\r\n                                    提交\r\n                                </Button>\r\n                            </Form.Item>\r\n                        </Form>\r\n                    </>\r\n                )}\r\n            </Container>\r\n        </Drawer>\r\n    );\r\n};\r\n\r\nconst Container = styled.div`\r\n  height: 80vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n`;","import { useHttp } from \"utils/http\";\r\nimport { QueryKey, useMutation, useQuery } from \"react-query\";\r\nimport { Epic } from \"types/epic\";\r\nimport {useAddConfig, useDeleteConfig} from \"./use-optimistic-opinion\";\r\n\r\nexport const useEpics = (param?: Partial<Epic>) => {\r\n    const client = useHttp();\r\n\r\n    return useQuery<Epic[]>([\"epics\", param], () =>\r\n        client(\"epics\", { data: param })\r\n    );\r\n};\r\n\r\nexport const useAddEpic = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n\r\n    return useMutation(\r\n        (params: Partial<Epic>) =>\r\n            client(`epics`, {\r\n                data: params,\r\n                method: \"POST\",\r\n            }),\r\n        useAddConfig(queryKey)\r\n    );\r\n};\r\n\r\nexport const useDeleteEpic = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n\r\n    return useMutation(\r\n        ({ id }: { id: number }) =>\r\n            client(`epics/${id}`, {\r\n                method: \"DELETE\",\r\n            }),\r\n        useDeleteConfig(queryKey)\r\n    );\r\n};\r\n\r\n","import React, { useState } from \"react\";\r\nimport { Row, ScreenContainer } from \"components/lib\";\r\nimport { useProjectInUrl } from \"screens/kanban/util\";\r\nimport { useDeleteEpic, useEpics } from \"utils/epic\";\r\nimport { Button, List, Modal } from \"antd\";\r\nimport dayjs from \"dayjs\";\r\nimport { useTasks } from \"utils/task\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useEpicSearchParams, useEpicsQueryKey } from \"./util\";\r\nimport { Epic } from \"types/epic\";\r\nimport { CreateEpic } from \"./create-epic\";\r\n\r\nexport const EpicScreen = () => {\r\n    const { data: currentProject } = useProjectInUrl();\r\n    const { data: epics } = useEpics(useEpicSearchParams());\r\n    const { data: tasks } = useTasks({ projectId: currentProject?.id });\r\n    const { mutate: deleteEpic } = useDeleteEpic(useEpicsQueryKey());\r\n    const [epicCreateOpen, setEpicCreateOpen] = useState(false);\r\n\r\n    const confirmDeleteEpic = (epic: Epic) => {\r\n        Modal.confirm({\r\n            title: `确定删除项目组：${epic.name}`,\r\n            content: \"点击确定删除\",\r\n            okText: \"确定\",\r\n            onOk() {\r\n                deleteEpic({ id: epic.id });\r\n            },\r\n        });\r\n    };\r\n\r\n    return (\r\n        <ScreenContainer>\r\n            <Row between={true}>\r\n                <h1>{currentProject?.name}任务组</h1>\r\n                <Button onClick={() => setEpicCreateOpen(true)} type={\"link\"}>\r\n                    创建任务组\r\n                </Button>\r\n            </Row>\r\n            <List\r\n                style={{ overflow: \"scroll\" }}\r\n                dataSource={epics}\r\n                itemLayout={\"vertical\"}\r\n                renderItem={(epic) => (\r\n                    <List.Item>\r\n                        <List.Item.Meta\r\n                            title={\r\n                                <Row between={true}>\r\n                                    <span>{epic.name}</span>\r\n                                    <Button onClick={() => confirmDeleteEpic(epic)} type={\"link\"}>\r\n                                        删除\r\n                                    </Button>\r\n                                </Row>\r\n                            }\r\n                            description={\r\n                                <div>\r\n                                    <div>开始时间：{dayjs(epic.start).format(\"YYYY-MM-DD\")}</div>\r\n                                    <div>结束时间：{dayjs(epic.end).format(\"YYYY-MM-DD\")}</div>\r\n                                </div>\r\n                            }\r\n                        />\r\n                        <div>\r\n                            {tasks\r\n                                ?.filter((task) => task.epicId === epic.id)\r\n                                .map((task) => (\r\n                                    <Link\r\n                                        to={`/projects/${currentProject?.id}/kanban?editingTaskId=${task.id}`}\r\n                                        key={task.id}\r\n                                    >\r\n                                        {task.name}\r\n                                    </Link>\r\n                                ))}\r\n                        </div>\r\n                    </List.Item>\r\n                )}\r\n            />\r\n            <CreateEpic\r\n                onClose={() => setEpicCreateOpen(false)}\r\n                visible={epicCreateOpen}\r\n            />\r\n        </ScreenContainer>\r\n    );\r\n};","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport {Navigate, Route, Routes, useLocation} from \"react-router\";\r\nimport { KanbanScreen } from \"screens/kanban\";\r\nimport { EpicScreen } from \"screens/epic\";\r\nimport styled from \"@emotion/styled\";\r\nimport {Menu} from \"antd\"\r\n\r\nconst useRouteType = () => {\r\n    const units = useLocation().pathname.split('./')\r\n    return units[units.length - 1];\r\n}\r\n\r\nexport const ProjectScreen = () => {\r\n    const routeType = useRouteType()\r\n    return (\r\n        <Container>\r\n            <Aside>\r\n                <Menu mode={\"inline\"} selectedKeys={[routeType]}>\r\n                    <Menu.Item key ={'kanban'}>\r\n                        <Link to={\"kanban\"}>看板</Link>\r\n                    </Menu.Item>\r\n                    <Menu.Item key ={'epic'}>\r\n                        <Link to={\"epic\"}>任务组</Link>\r\n                    </Menu.Item>\r\n                </Menu>\r\n            </Aside>\r\n            <Main>\r\n            <Routes>\r\n                {/*projects/:projectId/kanban*/}\r\n                <Route path={\"/kanban\"} element={<KanbanScreen />} />\r\n                {/*projects/:projectId/epic*/}\r\n                <Route path={\"/epic\"} element={<EpicScreen />} />\r\n                <Navigate to={window.location.pathname + \"/kanban\"} replace={true}/>\r\n            </Routes>\r\n            </Main>\r\n        </Container>\r\n    );\r\n};\r\n\r\nconst Aside = styled.aside`\r\n    background-color: rgb(244,245,247);\r\n    display: flex;\r\n    `\r\n\r\nconst Main = styled.div`\r\n    box-shadow: -5px 0 5px -5px rgba(0,0,0,0.1);\r\n    display: flex;\r\n    `\r\n\r\nconst Container = styled.div`\r\n    display: grid;\r\n    grid-template-columns: 16rem 1fr;\r\n  overflow: hidden;\r\n  `","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"linearGradient\", {\n  x1: \"97.6553341%\",\n  y1: \"35.6591143%\",\n  x2: \"37.202032%\",\n  y2: \"75.4891864%\",\n  id: \"uid392-1\"\n}, /*#__PURE__*/React.createElement(\"stop\", {\n  stopColor: \"#0052CC\",\n  offset: \"7%\"\n}), /*#__PURE__*/React.createElement(\"stop\", {\n  stopColor: \"#2684FF\",\n  offset: \"100%\"\n})), /*#__PURE__*/React.createElement(\"linearGradient\", {\n  x1: \"8.43371138%\",\n  y1: \"60.1495759%\",\n  x2: \"64.1161517%\",\n  y2: \"23.5790285%\",\n  id: \"uid392-2\"\n}, /*#__PURE__*/React.createElement(\"stop\", {\n  stopColor: \"#0052CC\",\n  offset: \"0%\"\n}), /*#__PURE__*/React.createElement(\"stop\", {\n  stopColor: \"#2684FF\",\n  offset: \"100%\"\n})));\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"g\", {\n  stroke: \"none\",\n  strokeWidth: 1,\n  fillRule: \"nonzero\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M11.3881081,27.9242105 C12.4881804,26.8071817 13.1062496,25.2917664 13.1062496,23.7115789 C13.1062496,22.1313915 12.4881804,20.6159762 11.3881081,19.4989474 L11.3881081,19.4989474 L3.74837838,11.7621053 L0.273513514,15.2926316 C-0.0900771727,15.6625064 -0.0900771727,16.2617042 0.273513514,16.6315789 L11.3881081,27.9242105 L11.3881081,27.9242105 Z\",\n  fill: \"currentColor\",\n  fillRule: \"nonzero\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M22.5027027,15.2926316 L11.3881081,4 L11.3881081,4 L11.3539189,4.03473684 L11.3539189,4.03473684 C9.08852466,6.36456187 9.09963243,10.1156459 11.3787838,12.4315789 L19.0247297,20.1652632 L22.5027027,16.6315789 C22.8662934,16.2617042 22.8662934,15.6625064 22.5027027,15.2926316 Z\",\n  fill: \"currentColor\",\n  fillRule: \"nonzero\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M11.3881081,12.4252632 C9.10895676,10.1093301 9.09784899,6.35824608 11.3632432,4.02842105 L3.43445946,12.0810526 L7.58067568,16.2936842 L11.3881081,12.4252632 Z\",\n  fill: \"url(#uid392-1)\",\n  fillRule: \"nonzero\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M15.1893243,15.6368421 L11.3881081,19.4989474 C12.4881804,20.6159762 13.1062496,22.1313915 13.1062496,23.7115789 C13.1062496,25.2917664 12.4881804,26.8071817 11.3881081,27.9242105 L19.3355405,19.8494737 L15.1893243,15.6368421 Z\",\n  fill: \"url(#uid392-2)\",\n  fillRule: \"nonzero\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M36.07,18.956 C36.07,20.646 35.394,21.842 33.418,21.842 C32.56,21.842 31.702,21.686 31,21.4 L31,23.662 C31.65,23.896 32.586,24.104 33.808,24.104 C37.032,24.104 38.41,21.946 38.41,18.8 L38.41,6.918 L36.07,6.918 L36.07,18.956 Z M41.894,7.568 C41.894,8.556 42.544,9.128 43.454,9.128 C44.364,9.128 45.014,8.556 45.014,7.568 C45.014,6.58 44.364,6.008 43.454,6.008 C42.544,6.008 41.894,6.58 41.894,7.568 Z M42.31,24 L44.546,24 L44.546,11 L42.31,11 L42.31,24 Z M47.926,24 L50.11,24 L50.11,16.33 C50.11,13.574 51.852,12.716 54.712,13.002 L54.712,10.818 C52.164,10.662 50.864,11.754 50.11,13.288 L50.11,11 L47.926,11 L47.926,24 Z M65.45,24 L65.45,21.66 C64.618,23.376 63.058,24.26 61.056,24.26 C57.598,24.26 55.856,21.322 55.856,17.5 C55.856,13.834 57.676,10.74 61.316,10.74 C63.214,10.74 64.67,11.598 65.45,13.288 L65.45,11 L67.686,11 L67.686,24 L65.45,24 Z M58.092,17.5 C58.092,20.62 59.34,22.18 61.654,22.18 C63.656,22.18 65.45,20.906 65.45,18.02 L65.45,16.98 C65.45,14.094 63.812,12.82 61.914,12.82 C59.392,12.82 58.092,14.484 58.092,17.5 Z M86.926,19.294 C86.926,16.226 84.898,15.056 81.284,14.146 C78.268,13.392 77.176,12.69 77.176,11.286 C77.176,9.726 78.502,8.946 80.738,8.946 C82.506,8.946 84.352,9.258 86.068,10.246 L86.068,7.906 C84.898,7.256 83.312,6.658 80.842,6.658 C76.864,6.658 74.836,8.634 74.836,11.286 C74.836,14.094 76.552,15.42 80.4,16.356 C83.65,17.136 84.586,17.942 84.586,19.45 C84.586,20.958 83.624,21.972 81.05,21.972 C78.788,21.972 76.344,21.374 74.758,20.542 L74.758,22.934 C76.084,23.61 77.618,24.26 80.92,24.26 C85.158,24.26 86.926,22.258 86.926,19.294 Z M95.09,24.26 C91.19,24.26 88.902,21.374 88.902,17.474 C88.902,13.574 91.19,10.74 95.09,10.74 C98.964,10.74 101.226,13.574 101.226,17.474 C101.226,21.374 98.964,24.26 95.09,24.26 Z M95.09,12.82 C92.308,12.82 91.086,15.004 91.086,17.474 C91.086,19.944 92.308,22.18 95.09,22.18 C97.846,22.18 99.042,19.944 99.042,17.474 C99.042,15.004 97.846,12.82 95.09,12.82 Z M106.92,9.622 C106.92,8.452 107.596,7.646 108.974,7.646 C109.494,7.646 109.988,7.698 110.378,7.776 L110.378,5.722 C109.988,5.618 109.546,5.514 108.87,5.514 C106.088,5.514 104.736,7.152 104.736,9.57 L104.736,11 L102.63,11 L102.63,13.08 L104.736,13.08 L104.736,24 L106.92,24 L106.92,13.08 L110.274,13.08 L110.274,11 L106.92,11 L106.92,9.622 Z M115.786,19.892 L115.786,13.08 L119.244,13.08 L119.244,11 L115.786,11 L115.786,8.244 L113.602,8.244 L113.602,11 L111.496,11 L111.496,13.08 L113.602,13.08 L113.602,19.944 C113.602,22.362 114.954,24 117.736,24 C118.412,24 118.854,23.896 119.244,23.792 L119.244,21.634 C118.854,21.712 118.36,21.816 117.84,21.816 C116.462,21.816 115.786,21.036 115.786,19.892 Z M125.432,24 L128.292,24 L130.528,17.708 L131.724,13.704 L132.92,17.708 L135.156,24 L138.016,24 L142.8,11 L140.33,11 L136.586,22.024 L132.79,11 L130.658,11 L126.862,22.024 L123.118,11 L120.648,11 L125.432,24 Z M153.538,24 L153.538,21.66 C152.706,23.376 151.146,24.26 149.144,24.26 C145.686,24.26 143.944,21.322 143.944,17.5 C143.944,13.834 145.764,10.74 149.404,10.74 C151.302,10.74 152.758,11.598 153.538,13.288 L153.538,11 L155.774,11 L155.774,24 L153.538,24 Z M146.18,17.5 C146.18,20.62 147.428,22.18 149.742,22.18 C151.744,22.18 153.538,20.906 153.538,18.02 L153.538,16.98 C153.538,14.094 151.9,12.82 150.002,12.82 C147.48,12.82 146.18,14.484 146.18,17.5 Z M159.154,24 L161.338,24 L161.338,16.33 C161.338,13.574 163.08,12.716 165.94,13.002 L165.94,10.818 C163.392,10.662 162.092,11.754 161.338,13.288 L161.338,11 L159.154,11 L159.154,24 Z M178.108,23.48 C177.042,24.052 175.404,24.26 174.078,24.26 C169.216,24.26 167.084,21.452 167.084,17.474 C167.084,13.548 169.268,10.74 173.22,10.74 C177.224,10.74 178.836,13.522 178.836,17.474 L178.836,18.488 L169.346,18.488 C169.658,20.698 171.088,22.128 174.156,22.128 C175.664,22.128 176.938,21.842 178.108,21.426 L178.108,23.48 Z M173.116,12.768 C170.75,12.768 169.554,14.302 169.32,16.564 L176.574,16.564 C176.444,14.146 175.352,12.768 173.116,12.768 Z\",\n  fill: \"inherit\",\n  fillRule: \"evenodd\"\n}));\n\nfunction SvgSoftwareLogo(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    viewBox: \"0 0 179 32\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    focusable: \"false\",\n    \"aria-hidden\": \"true\",\n    className: \"css-sq9aeg-Logo\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2, _ref3);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgSoftwareLogo);\nexport default __webpack_public_path__ + \"static/media/software-logo.f95e3f92.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useEffect } from \"react\";\r\nimport { Button, Drawer, Form, Input, Spin } from \"antd\";\r\nimport {useProjectModal, useProjectsQueryKey} from \"screens/project-list/util\";\r\nimport { UserSelect } from \"components/user-select\";\r\nimport { useAddProject, useEditProject } from \"utils/project\";\r\nimport { ErrorBox } from \"components/lib\";\r\nimport styled from \"@emotion/styled\";\r\n\r\nexport const ProjectModal = () => {\r\n    const {\r\n        projectModalOpen,\r\n        close,\r\n        editingProject,\r\n        isLoading,\r\n    } = useProjectModal();\r\n    const useMutateProject = editingProject ? useEditProject : useAddProject;\r\n\r\n    const { mutateAsync, error, isLoading: mutateLoading } = useMutateProject(useProjectsQueryKey());\r\n    const [form] = Form.useForm();\r\n    const onFinish = (values: any) => {\r\n        mutateAsync({ ...editingProject, ...values }).then(() => {\r\n            form.resetFields();\r\n            close();\r\n        });\r\n    };\r\n    const closeModal = () => {\r\n        form.resetFields()\r\n        close()\r\n    }\r\n\r\n    const title = editingProject ? \"编辑项目\" : \"创建项目\";\r\n\r\n    useEffect(() => {\r\n        form.setFieldsValue(editingProject);\r\n    }, [editingProject, form]);\r\n\r\n    return (\r\n        <Drawer\r\n            forceRender={true}\r\n            onClose={closeModal}\r\n            visible={projectModalOpen}\r\n            width={\"100%\"}\r\n        >\r\n            <Container>\r\n                {isLoading ? (\r\n                    <Spin size={\"large\"} />\r\n                ) : (\r\n                    <>\r\n                        <h1>{title}</h1>\r\n                        <ErrorBox error={error} />\r\n                        <Form\r\n                            form={form}\r\n                            layout={\"vertical\"}\r\n                            style={{ width: \"40rem\" }}\r\n                            onFinish={onFinish}\r\n                        >\r\n                            <Form.Item\r\n                                label={\"名称\"}\r\n                                name={\"name\"}\r\n                                rules={[{ required: true, message: \"请输入项目名\" }]}\r\n                            >\r\n                                <Input placeholder={\"请输入项目名称\"} />\r\n                            </Form.Item>\r\n\r\n                            <Form.Item\r\n                                label={\"部门\"}\r\n                                name={\"organization\"}\r\n                                rules={[{ required: true, message: \"请输入部门名\" }]}\r\n                            >\r\n                                <Input placeholder={\"请输入部门名\"} />\r\n                            </Form.Item>\r\n\r\n                            <Form.Item label={\"负责人\"} name={\"personId\"}>\r\n                                <UserSelect defaultOptionName={\"负责人\"} />\r\n                            </Form.Item>\r\n\r\n                            <Form.Item style={{ textAlign: \"right\" }}>\r\n                                <Button\r\n                                    loading={mutateLoading}\r\n                                    type={\"primary\"}\r\n                                    htmlType={\"submit\"}\r\n                                >\r\n                                    提交\r\n                                </Button>\r\n                            </Form.Item>\r\n                        </Form>\r\n                    </>\r\n                )}\r\n            </Container>\r\n        </Drawer>\r\n    );\r\n};\r\n\r\nconst Container = styled.div`\r\n  height: 80vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n`;\r\n","import React from \"react\";\r\nimport {Popover, List, Typography, Divider} from \"antd\";\r\nimport {useProjects} from \"../utils/project\";\r\nimport styled from \"@emotion/styled\";\r\nimport {ButtonNoPadding} from \"./lib\";\r\nimport {useProjectModal} from \"../screens/project-list/util\";\r\n\r\nexport const ProjectPopover = () => {\r\n    const {open} = useProjectModal()\r\n    const { data: projects, refetch } = useProjects();\r\n    const pinnedProjects = projects?.filter((project) => project.pin)\r\n\r\n    const content =(\r\n        <ContentContainer>\r\n        <Typography.Text type={\"secondary\"}>收藏项目</Typography.Text>\r\n        <List>\r\n            {\r\n                pinnedProjects?.map(project => <List.Item>\r\n                    <List.Item.Meta title = {project.name}/>\r\n                </List.Item>)\r\n            }\r\n        </List>\r\n        <Divider/>\r\n        <ButtonNoPadding onClick={open} type={\"link\"}>创建项目</ButtonNoPadding>\r\n    </ContentContainer>\r\n    )\r\n    return(\r\n        <Popover\r\n            onVisibleChange={() => refetch()}\r\n            placement={\"bottom\"}\r\n            content={content}\r\n        >\r\n            <span>项目</span>\r\n        </Popover>\r\n    )\r\n}\r\n\r\nconst ContentContainer = styled.div`\r\n  min-width: 30rem;\r\n`;","import React from \"react\";\r\nimport { Divider, List, Popover, Typography } from \"antd\";\r\nimport styled from \"@emotion/styled\";\r\nimport { useUsers } from \"utils/user\";\r\n\r\nexport const UserPopover = () => {\r\n    const { data: users, refetch } = useUsers();\r\n\r\n    const content = (\r\n        <ContentContainer>\r\n            <Typography.Text type={\"secondary\"}>组员列表</Typography.Text>\r\n            <List>\r\n                {users?.map((user) => (\r\n                    <List.Item key={user.id}>\r\n                        <List.Item.Meta title={user.name} />\r\n                    </List.Item>\r\n                ))}\r\n            </List>\r\n            <Divider />\r\n        </ContentContainer>\r\n    );\r\n\r\n    return (\r\n        <Popover\r\n            onVisibleChange={() => refetch()}\r\n            placement={\"bottom\"}\r\n            content={content}\r\n        >\r\n            <span>组员</span>\r\n        </Popover>\r\n    );\r\n};\r\n\r\nconst ContentContainer = styled.div`\r\n  min-width: 30rem;\r\n`;","import React from \"react\";\r\nimport { ProjectListScreen } from \"screens/project-list\";\r\nimport {ProjectScreen} from \"./screens/project\";\r\nimport { useAuth } from \"context/auth-context\";\r\nimport styled from \"@emotion/styled\";\r\nimport {ButtonNoPadding, Row} from \"components/lib\";\r\nimport { ReactComponent as SoftwareLogo } from \"assets/software-logo.svg\";\r\nimport { Button, Dropdown, Menu } from \"antd\";\r\nimport { Route, Routes, Navigate } from 'react-router'\r\nimport { resetRoute } from \"utils\";\r\nimport {ProjectModal} from \"./screens/project-list/project-modal\";\r\nimport {ProjectPopover} from \"./components/project-popover\";\r\nimport {UserPopover} from \"./components/user-popover\";\r\n\r\n/**\r\n * grid 和 flex 各自的应用场景\r\n * 1. 要考虑，是一维布局 还是 二维布局\r\n * 一般来说，一维布局用flex，二维布局用grid\r\n * 2. 是从内容出发还是从布局出发？\r\n * 从内容出发：你先有一组内容(数量一般不固定),然后希望他们均匀的分布在容器中，由内容自己的大小决定占据的空间\r\n * 从布局出发：先规划网格(数量一般比较固定)，然后再把元素往里填充\r\n * 从内容出发，用flex\r\n * 从布局出发，用grid\r\n *\r\n */\r\n\r\nexport default () => {\r\n    return (\r\n        <Container>\r\n            <PageHeader />\r\n            <Main>\r\n                    <Routes>\r\n                        <Route path={'/projects'} element={<ProjectListScreen/>}/>\r\n                        <Route path={'/projects/:projectId/*'} element={<ProjectScreen/>}/>\r\n                        <Navigate to={'/projects'}/>\r\n                    </Routes>\r\n            </Main>\r\n            <ProjectModal/>\r\n        </Container>\r\n    );\r\n};\r\n\r\nconst PageHeader = () => {\r\n    return <Header between={true}>\r\n        <HeaderLeft gap={true}>\r\n            <ButtonNoPadding  type={\"link\"} onClick={resetRoute}>\r\n                <SoftwareLogo width={\"18rem\"} color={\"rgb(38, 132, 255)\"} />\r\n            </ButtonNoPadding>\r\n            <ProjectPopover />\r\n            <UserPopover/>\r\n        </HeaderLeft>\r\n        <HeaderRight>\r\n            <User/>\r\n        </HeaderRight>\r\n    </Header>\r\n}\r\n\r\nconst User = () => {\r\n    const { logout, user } = useAuth();\r\n    return <Dropdown overlay={\r\n        <Menu>\r\n            <Menu.Item key={'logout'}>\r\n                <Button onClick={logout} type={\"link\"}>\r\n                    登出\r\n                </Button>\r\n            </Menu.Item>\r\n        </Menu>\r\n    }>\r\n        <Button type={\"link\"} onClick={(e) => e.preventDefault()}>\r\n            Hi, {user?.name}\r\n        </Button>\r\n    </Dropdown>\r\n}\r\n\r\nconst Container = styled.div`\r\n  display: grid;\r\n  grid-template-rows: 6rem 1fr;\r\n  height: 100vh;\r\n`;\r\n\r\n// grid-area 用来给grid子元素起名字\r\nconst Header = styled(Row)`\r\n  padding: 3.2rem;\r\n  box-shadow: 0 0 5px 0 rgba(0,0,0,0);\r\n  z-index: 1;\r\n`;\r\nconst HeaderLeft = styled(Row)``;\r\nconst HeaderRight = styled.div``;\r\nconst Main = styled.main`\r\n  //display: flex;\r\n  overflow: hidden;\r\n`;"],"sourceRoot":""}